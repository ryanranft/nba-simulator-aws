# Sub-Phase 9.5: Unified Box Score Storage System

**Status:** ⏸️ PENDING
**Priority:** HIGH
**Timeline:** 1 week
**Dependencies:** 9.1 (need data to store)
**Started:** Not started
**Completed:** Not completed

---

## Objective

Implement efficient storage for generated box score snapshots with fast temporal query capability.

---

## Storage Strategy

**1. RDS PostgreSQL** (for queries)
- `game_state_snapshots` table
- `player_snapshot_stats` table
- `quarter_box_scores` table
- `box_score_verification` table

**2. S3 Parquet** (for ML training)
- Path: `s3://nba-sim-raw-data-lake/box_score_snapshots/`
- Partitioned by: season, month, game_id
- Format: Parquet with Snappy compression

**3. Local SQLite** (for development)
- Recent games cached locally
- Fast iteration during development

---

## Compression Targets

- Parquet compression ratio: 10:1 minimum
- Expected storage: ~5 GB for all games
- Query response: <100ms for single game

---

## Implementation

```python
class StorageManager:
    def save_snapshot_to_rds(self, snapshot: BoxScoreSnapshot) -> int:
        """Save snapshot to PostgreSQL"""
        pass

    def save_snapshots_to_parquet(self, snapshots: List[BoxScoreSnapshot], path: str):
        """Save to S3 Parquet for ML training"""
        pass

    def cache_locally(self, game_id: str, snapshots: List[BoxScoreSnapshot]):
        """Cache in local SQLite"""
        pass
```

---

## Success Criteria

- ✅ All snapshots stored in RDS
- ✅ Parquet files uploaded to S3
- ✅ Query response <100ms
- ✅ Compression ratio >10:1

---

## References

- **Complete Plan**: `~/Downloads/pbp_to_boxscore_plan.md` - Section 8.5

---

**Status:** Ready after 9.1 generates data


